{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/user.service\";\nimport * as i2 from \"@angular/forms\";\nexport let EditProfileComponent = /*#__PURE__*/(() => {\n  class EditProfileComponent {\n    constructor(user_service) {\n      this.user_service = user_service;\n    }\n\n    ngOnInit() {\n      let curr_userName = sessionStorage.getItem('userName');\n      let resp = this.user_service.getUserByUsername(curr_userName);\n      resp.subscribe(response => {\n        let user_details = response['user'][0];\n        console.log(user_details);\n        this.user_firstName = user_details['firstName'];\n        this.user_lastName = user_details['lastName'];\n        this.user_address = user_details['userAddress'];\n        this.user_email = user_details['email'];\n        this.user_dob = user_details['dod'];\n        this.user_phoneNumber = user_details['phoneNumber'];\n      });\n    }\n\n    submitEdits(editProfileRef) {\n      let fname = document.getElementById('f_fname');\n      let lname = document.getElementById('f_lname');\n      let email = document.getElementById('f_email');\n      let address = document.getElementById('f_address');\n      let dob = document.getElementById('f_dob');\n      let phoneNum = document.getElementById('f_phoneNum');\n      fname.value = \"\";\n      lname.value = \"\";\n      email.value = \"\";\n      address.value = \"\";\n      dob.value = \"\";\n      phoneNum.value = \"\"; // Grab the currently logged in username from sessionStorage\n\n      let curr_userName = sessionStorage.getItem('userName');\n      let emailCheck = true;\n      editProfileRef['userName'] = curr_userName;\n      let final_UserEdits = {};\n\n      for (let [k, v] of Object.entries(editProfileRef)) {\n        console.log(k);\n\n        if (v != \"\") {\n          if (k == \"email\") {\n            if (this.user_service.regexp.test(editProfileRef.email)) {\n              final_UserEdits[k] = v;\n            } else {\n              emailCheck = false;\n              break;\n            }\n          } else {\n            final_UserEdits[k] = v;\n          }\n        }\n      }\n\n      console.log(final_UserEdits);\n\n      if (emailCheck) {\n        this.user_service.updateProfile(final_UserEdits);\n        alert(\"Profile has been updated\");\n      } else {\n        alert(\"Invalid email\");\n      }\n    }\n\n    submitNewPassword(updatePasswordRef) {\n      console.log(updatePasswordRef);\n      let curr_userName = sessionStorage.getItem('userName');\n      let resp = this.user_service.getUserByUsername(curr_userName);\n      resp.subscribe(response => {\n        let user_details = response['user'][0];\n        console.log(user_details);\n\n        if (updatePasswordRef['f_newPassword1'] != updatePasswordRef['f_newPassword2']) {\n          this.password1Res = \"❌ Password didn't match!\";\n          this.password2Res = \"❌ Password didn't match!\";\n        } else {\n          if (updatePasswordRef['f_currPassword'] == user_details['password']) {\n            console.log(\"Match!\"); // prep data to be changed\n\n            let update_details = {\n              userName: curr_userName,\n              password: updatePasswordRef['f_newPassword1']\n            }; // Send PUT request for password change\n\n            this.user_service.updatePassword(update_details).subscribe(res => {\n              if (res.status) {\n                alert(\"Your password has been successfully changed!\");\n              } else {\n                alert(\"Password could not be changed! Try again!\");\n              }\n            });\n          }\n        }\n      });\n    }\n\n  }\n\n  EditProfileComponent.ɵfac = function EditProfileComponent_Factory(t) {\n    return new (t || EditProfileComponent)(i0.ɵɵdirectiveInject(i1.UserService));\n  };\n\n  EditProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditProfileComponent,\n    selectors: [[\"app-edit-profile\"]],\n    decls: 116,\n    vars: 8,\n    consts: [[1, \"container\"], [1, \"row\"], [1, \"col\"], [1, \"CurrentUserInfo\"], [1, \"infoType\"], [1, \"infoAnswer\"], [1, \"editProfileContent\", 2, \"box-shadow\", \"0 4px 8px 0 rgba(0, 0, 0, 0.3), 0 6px 20px 0 rgba(0, 0, 0, 0.3)\"], [3, \"ngSubmit\"], [\"editProfileRef\", \"ngForm\"], [1, \"form-floating\", \"mb-3\"], [\"type\", \"text\", \"id\", \"f_fname\", \"name\", \"firstName\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_email\"], [\"type\", \"text\", \"id\", \"f_lname\", \"name\", \"lastName\", \"ngModel\", \"\", 1, \"form-control\"], [\"type\", \"email\", \"id\", \"f_email\", \"name\", \"email\", \"ngModel\", \"\", 1, \"form-control\"], [\"type\", \"text\", \"id\", \"f_address\", \"name\", \"userAddress\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_address\"], [\"type\", \"text\", \"id\", \"f_dob\", \"name\", \"dod\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_dob\"], [\"type\", \"text\", \"id\", \"f_phoneNum\", \"name\", \"phoneNumber\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_phoneNum\"], [\"type\", \"submit\", \"value\", \"Done\", 1, \"btn\", \"btn-primary\", \"formBtn\"], [\"type\", \"reset\", \"value\", \"Reset\", 1, \"btn\", \"btn-secondary\", \"formBtn\"], [1, \"updatePasswordContent\", 2, \"box-shadow\", \"0 4px 8px 0 rgba(0, 0, 0, 0.3), 0 6px 20px 0 rgba(0, 0, 0, 0.3)\"], [\"updatePasswordRef\", \"ngForm\"], [\"type\", \"password\", \"id\", \"f_currPassword\", \"name\", \"f_currPassword\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_currPassword\"], [\"type\", \"password\", \"id\", \"f_newPassword1\", \"name\", \"f_newPassword1\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_newPassword1\"], [1, \"invalidPass\"], [\"type\", \"password\", \"id\", \"f_newPassword2\", \"name\", \"f_newPassword2\", \"ngModel\", \"\", 1, \"form-control\"], [\"for\", \"f_newPassword2\"]],\n    template: function EditProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r2 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n        i0.ɵɵtext(2, \"Edit Profile\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"h3\");\n        i0.ɵɵtext(4, \"Basic Details Update\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 1)(6, \"div\", 2)(7, \"div\", 3)(8, \"div\", 1)(9, \"div\", 2)(10, \"div\", 1)(11, \"p\", 4);\n        i0.ɵɵtext(12, \"First Name: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"p\", 5);\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 1)(16, \"p\", 4);\n        i0.ɵɵtext(17, \"Last Name: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"p\", 5);\n        i0.ɵɵtext(19);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"div\", 1)(21, \"p\", 4);\n        i0.ɵɵtext(22, \"E-Mail: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"p\", 5);\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(25, \"div\", 2)(26, \"div\", 1)(27, \"p\", 4);\n        i0.ɵɵtext(28, \"Address: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"p\", 5);\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(31, \"div\", 1)(32, \"p\", 4);\n        i0.ɵɵtext(33, \"Date of Birth: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"p\", 5);\n        i0.ɵɵtext(35);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"div\", 1)(37, \"p\", 4);\n        i0.ɵɵtext(38, \"Phone Number: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"p\", 5);\n        i0.ɵɵtext(40);\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(41, \"div\", 2)(42, \"div\", 6)(43, \"form\", 7, 8);\n        i0.ɵɵlistener(\"ngSubmit\", function EditProfileComponent_Template_form_ngSubmit_43_listener() {\n          i0.ɵɵrestoreView(_r2);\n\n          const _r0 = i0.ɵɵreference(44);\n\n          return ctx.submitEdits(_r0.value);\n        });\n        i0.ɵɵelementStart(45, \"div\", 1)(46, \"div\", 2)(47, \"div\", 1)(48, \"div\", 2)(49, \"div\", 9);\n        i0.ɵɵelement(50, \"input\", 10);\n        i0.ɵɵelementStart(51, \"label\", 11);\n        i0.ɵɵtext(52, \"First Name\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(53, \"div\", 2)(54, \"div\", 9);\n        i0.ɵɵelement(55, \"input\", 12);\n        i0.ɵɵelementStart(56, \"label\", 11);\n        i0.ɵɵtext(57, \"Last Name\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(58, \"div\", 9);\n        i0.ɵɵelement(59, \"input\", 13);\n        i0.ɵɵelementStart(60, \"label\", 11);\n        i0.ɵɵtext(61, \"E-mail\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(62, \"div\", 9);\n        i0.ɵɵelement(63, \"input\", 14);\n        i0.ɵɵelementStart(64, \"label\", 15);\n        i0.ɵɵtext(65, \"Address\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(66, \"div\", 1)(67, \"div\", 2)(68, \"div\", 9);\n        i0.ɵɵelement(69, \"input\", 16);\n        i0.ɵɵelementStart(70, \"label\", 17);\n        i0.ɵɵtext(71, \"Date of Birth\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(72, \"div\", 2)(73, \"div\", 9);\n        i0.ɵɵelement(74, \"input\", 18);\n        i0.ɵɵelementStart(75, \"label\", 19);\n        i0.ɵɵtext(76, \"Phone Number\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(77, \"div\", 1)(78, \"div\", 2);\n        i0.ɵɵelement(79, \"input\", 20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(80, \"div\", 2);\n        i0.ɵɵelement(81, \"input\", 21);\n        i0.ɵɵelementEnd()()()()()()()();\n        i0.ɵɵelement(82, \"hr\");\n        i0.ɵɵelementStart(83, \"h3\");\n        i0.ɵɵtext(84, \"Forgot your password? Change it here!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(85, \"br\");\n        i0.ɵɵelementStart(86, \"div\", 22)(87, \"form\", 7, 23);\n        i0.ɵɵlistener(\"ngSubmit\", function EditProfileComponent_Template_form_ngSubmit_87_listener() {\n          i0.ɵɵrestoreView(_r2);\n\n          const _r1 = i0.ɵɵreference(88);\n\n          return ctx.submitNewPassword(_r1.value);\n        });\n        i0.ɵɵelementStart(89, \"div\", 1)(90, \"div\", 2)(91, \"div\", 9);\n        i0.ɵɵelement(92, \"input\", 24);\n        i0.ɵɵelementStart(93, \"label\", 25);\n        i0.ɵɵtext(94, \"Current Password\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(95, \"div\", 1)(96, \"div\", 2)(97, \"div\", 9);\n        i0.ɵɵelement(98, \"input\", 26);\n        i0.ɵɵelementStart(99, \"label\", 27);\n        i0.ɵɵtext(100, \"New Password\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(101, \"p\", 28);\n        i0.ɵɵtext(102);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(103, \"div\", 1)(104, \"div\", 2)(105, \"div\", 9);\n        i0.ɵɵelement(106, \"input\", 29);\n        i0.ɵɵelementStart(107, \"label\", 30);\n        i0.ɵɵtext(108, \"Confirm New Password\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(109, \"p\", 28);\n        i0.ɵɵtext(110);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(111, \"div\", 1)(112, \"div\", 2);\n        i0.ɵɵelement(113, \"input\", 20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(114, \"div\", 2);\n        i0.ɵɵelement(115, \"input\", 21);\n        i0.ɵɵelementEnd()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(14);\n        i0.ɵɵtextInterpolate(ctx.user_firstName);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(ctx.user_lastName);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(ctx.user_email);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.user_address);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(ctx.user_dob);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(ctx.user_phoneNumber);\n        i0.ɵɵadvance(62);\n        i0.ɵɵtextInterpolate(ctx.password1Res);\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(ctx.password2Res);\n      }\n    },\n    directives: [i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.NgForm, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel],\n    styles: [\"h2[_ngcontent-%COMP%]{margin:auto}h3[_ngcontent-%COMP%]{text-align:center}.CurrentUserInfo[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;font-size:20px}.infoType[_ngcontent-%COMP%]{font-weight:700}.editProfileContent[_ngcontent-%COMP%]{border:5px solid black;padding:15px;border-radius:10px}.updatePasswordContent[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:auto;display:flex;flex-direction:row;align-items:center;justify-content:center;border:5px solid black;border-radius:10px;padding:15px}.passInput[_ngcontent-%COMP%]{width:100%}.formBtn[_ngcontent-%COMP%]{width:100%;margin:5px}\"]\n  });\n  return EditProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}